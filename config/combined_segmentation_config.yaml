# Combined Segmentation Configuration
# This file configures the NARadio-based combined segmentation system

# Object List for Segmentation
# These objects will be encoded into embeddings and used for segmentation
objects:
  - "floor"
  - "ceiling" 
  - "wall"
  - "person"
  - "chair"
  - "table"

# NARadio Model Configuration
naradio:
  model_version: "radio_v2.5-b"
  lang_model: "siglip"
  input_resolution: 512
  enable_visualization: true
  batch_size: 4  # Number of words to encode at once

# Segmentation Processing Parameters
segmentation:
  # Similarity computation
  apply_softmax: true  # Apply softmax across words for better segmentation
  normalize_features: true  # Normalize features for cosine similarity
  
  # Enhanced embedding preference
  prefer_enhanced_embeddings: true  # Use enhanced embeddings when available, fallback to VLM text embeddings
  enhanced_similarity_threshold: 0.1  # Only use pixels with similarity > threshold for enhanced embeddings
  
  # DBSCAN clustering for refinement
  enable_dbscan: true
  dbscan_eps: 0.3
  dbscan_min_samples: 5
  
  # Color mapping for visualization
  colors:
    - [255, 0, 0]      # Red
    - [0, 255, 0]      # Green  
    - [0, 0, 255]      # Blue
    - [255, 255, 0]    # Yellow
    - [255, 0, 255]    # Magenta
    - [0, 255, 255]    # Cyan
    - [255, 128, 0]    # Orange
    - [128, 0, 255]    # Purple
    - [128, 128, 0]    # Olive
    - [0, 128, 128]    # Teal
    - [128, 0, 128]    # Maroon
    - [255, 165, 0]    # Orange Red
    - [75, 0, 130]     # Indigo
    - [240, 230, 140]  # Khaki
    - [255, 20, 147]   # Deep Pink

# Processing Settings
processing:
  # Memory management
  clear_cache_interval: 30.0  # Clear GPU cache every 30 seconds
  memory_fraction: 0.8  # Use 80% of available GPU memory
  
  # Processing frequency
  processing_rate: 10.0  # Hz - how often to process segmentation
  
  # Quality settings
  min_similarity_threshold: 0.1  # Minimum similarity score to consider
  max_objects_per_frame: 15  # Maximum number of objects to segment

# Output Configuration
output:
  # Publishers
  publish_original_mask: true
  publish_refined_mask: true
  publish_color_legend: true
  
  # Image encoding
  mask_encoding: "rgb8"
  
  # Save settings
  save_masks_to_buffer: true
  save_metadata: true

# Debug and Logging
debug:
  enable_timing: true
  print_memory_usage: true
  verbose_processing: false
  log_similarity_scores: false

# Semantic Bridge Configuration for Voxel Mapping
semantic_bridge:
  # Enable semantic voxel mapping
  enable_semantic_mapping: true
  
  # Hotspot detection thresholds
  hotspot_similarity_threshold: 0.6  # Minimum similarity to consider as hotspot
  min_hotspot_area: 100  # Minimum pixel area for hotspot regions
  
  # Communication settings
  publish_rate_limit: 2.0  # Max Hz for semantic region publishing
  max_regions_per_message: 10  # Limit regions to avoid large messages
  
  # VLM answer tracking
  recent_vlm_window_seconds: 5.0  # Only process VLM answers from last N seconds
  cleanup_interval_seconds: 60.0  # Clean old data every N seconds
  
  # Pose association
  max_pose_age_seconds: 1.0  # Maximum age of pose to use with similarity data
  
  # Camera and depth settings
  camera_intrinsics: [186.24, 186.24, 238.66, 141.63]  # [fx, fy, cx, cy]
  estimated_hotspot_depth: 1.5  # meters - depth assumption for 2D->3D projection
  
  # Performance settings
  enable_visualization_images: true  # Publish mask and overlay images for RViz 